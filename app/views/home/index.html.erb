<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document Upload and Preview</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <%= stylesheet_link_tag 'application', media: 'all' %>
</head>
<body>
  <!-- Header with Logo and Menu side by side -->
  <header class="header">
    <div class="logo-section">
      <%= link_to root_path do %>
        <%= image_tag 'pdf-fusion-logo.png', alt: 'PDF Fusion Logo', class: 'logo', width: "110", height: "auto" %>
      <% end %>
    </div>
    <nav class="menu">
      <ul>
        <li><%= link_to "Home", root_path %></li>
        <li><%= link_to "About", about_path %></li>
      </ul>
    </nav>
  </header>

  <div class="container">
    <h1>PDF Fusion</h1>

    <!-- CSV Upload Form -->
    <div class="upload-section">
      <h2>Upload CSV File</h2>
      <%= form_with url: upload_csv_path, local: true, multipart: true do %>
        <%= file_field_tag :file, accept: ".csv" %>
        <%= submit_tag "Upload", class: "btn btn-upload" %>
      <% end %>
    </div>

    <!-- Display number of rows if CSV is uploaded -->
    <% if session[:csv_data].present? %>
      <div class="info-section">
        <p>CSV uploaded with <%= session[:csv_data].size %> rows. Showing preview of first row:</p>
      </div>
    <% end %>

    <!-- PDF Preview Section -->
    <div class="pdf-preview-section">
      <%= render 'template', **@preview_data %>
    </div>
    
    <!-- Download Button -->
    <div class="download-section">
      <% if session[:csv_data].present? %>
        <h2>Download the Documents</h2>
        <%= link_to "Download PDF", download_pdf_path, class: "btn btn-primary" %>
      <% end %>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-links">
      <%= link_to "Home", root_path %>
      <%= link_to "About", about_path %>
    </div>
    <p class="footer-copyright">
      &copy; <%= Time.now.year %> PDF Fusion. All rights reserved.
    </p>
  </footer>
</body>
</html>